<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>3D ë‹¬ë ¥ ë³´ë“œê²Œì„</title>
  <style>
    /* í˜ì´ì§€ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    body {
      margin: 0;
      overflow: hidden;
      font-family: 'Arial', sans-serif;
      background-color: #87CEEB; /* í•˜ëŠ˜ìƒ‰ ë°°ê²½ */
    }

    /* ìƒë‹¨ UI ì»¨í…Œì´ë„ˆ */
    #ui-container {
      position: absolute;
      top: 10px; 
      left: 50%; 
      transform: translateX(-50%);
      display: flex; 
      gap: 10px; 
      z-index: 10; /* UIê°€ ì•ì— í‘œì‹œë˜ë„ë¡ */
    }
    button {
      background: #0f3460; 
      color: #fff; 
      border: none; 
      padding: 10px 15px;
      font-size: 16px; 
      cursor: pointer; 
      border-radius: 5px; 
      transition: 0.3s;
    }
    button:hover {
      background: #00c3ff;
    }

    /* ë‹¬ë ¥ ì»¨í…Œì´ë„ˆ (ë³´ë“œíŒ) */
    #calendar-container {
      position: absolute; 
      top: 60px; 
      left: 50%; 
      transform: translateX(-50%);
      display: grid; 
      grid-template-columns: repeat(7, 60px); /* 7ì—´, ì¹¸ ë„ˆë¹„ 60px */
      gap: 5px; 
      max-width: 500px; 
      z-index: 10; /* ë‹¬ë ¥ë„ UI ìœ„ì— í‘œì‹œ */
    }
    .day {
      width: 60px; 
      height: 60px; 
      display: flex; 
      flex-direction: column;
      align-items: center; 
      justify-content: center;
      border: 1px solid #ccc; 
      font-size: 16px; 
      background: #fff; 
      border-radius: 5px;
    }
    .sunday {
      background: #ff5757; 
      color: white;
    }
    .saturday {
      background: #579eff; 
      color: white;
    }
    .day span {
      font-size: 12px; 
      color: #666;
    }

    /* Three.js ìº”ë²„ìŠ¤ (ì”¬) */
    canvas {
      display: block;
      position: fixed; /* ë‹¬ë ¥ ë’¤ì— ê¹”ë¦¼ */
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      z-index: -1; /* UIë³´ë‹¤ ë’¤ë¡œ */
    }
  </style>
</head>
<body>

  <!-- ìƒë‹¨ UI: ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸° ë²„íŠ¼ -->
  <div id="ui-container">
    <button onclick="rollDice()">ğŸ² ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°</button>
  </div>

  <!-- ë‹¬ë ¥(ë³´ë“œíŒ) ì˜ì—­ -->
  <div id="calendar-container"></div>

  <!-- Three.js & TWEEN.js CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

  <script>
    let scene, camera, renderer;
    let player;               // ë³´íŠ¸(í”Œë ˆì´ì–´)
    let cubes = [];           // 3D íë¸Œ ë°°ì—´
    let playerPosition = 0;   // í”Œë ˆì´ì–´ì˜ í˜„ì¬ ì¹¸ (0~)
    let waveTime = 0;         // ë¬¼ê²° ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„

    // ì´ˆê¸° ì‹¤í–‰
    function init() {
      // ì”¬ ìƒì„± (ë°°ê²½: í•˜ëŠ˜ìƒ‰)
      scene = new THREE.Scene();
      scene.background = new THREE.Color(0x87CEEB);

      // ì¹´ë©”ë¼ ì„¤ì • (ì•½ê°„ ìœ„ì—ì„œ ë‚´ë ¤ë‹¤ë³´ë„ë¡)
      camera = new THREE.PerspectiveCamera(
        75, 
        window.innerWidth / window.innerHeight, 
        0.1, 
        1000
      );
      camera.position.set(0, 28, 22);
      camera.lookAt(0, 0, 0);

      // ë Œë”ëŸ¬ ì„¤ì •
      renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);

      // ì¡°ëª… ì¶”ê°€
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
      scene.add(ambientLight);

      const directionalLight = new THREE.DirectionalLight(0xffffff, 1.5);
      directionalLight.position.set(5, 15, 10);
      scene.add(directionalLight);

      // ë‹¬ë ¥(ë³´ë“œíŒ) ìƒì„±
      createCalendarBoard();

      // í”Œë ˆì´ì–´(ë³´íŠ¸) ìƒì„±
      createBoatPlayer();

      // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
      window.addEventListener('resize', onWindowResize);

      // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
      animate();
    }

    // ë‹¬ë ¥(ë³´ë“œíŒ) ìƒì„±
    function createCalendarBoard() {
      // ë‹¬ë ¥ HTML í‘œì‹œ
      const daysInMonth = 31;
      const daysOfWeek = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
      const calendarContainer = document.getElementById("calendar-container");
      calendarContainer.innerHTML = "";

      // ìš”ì¼ í—¤ë” 7ê°œ
      for (let i = 0; i < daysOfWeek.length; i++) {
        const dayHeader = document.createElement("div");
        dayHeader.classList.add("day");
        dayHeader.textContent = daysOfWeek[i];
        if (i === 0) dayHeader.classList.add("sunday");
        if (i === 6) dayHeader.classList.add("saturday");
        calendarContainer.appendChild(dayHeader);
      }

      // ë‚ ì§œ 31ê°œ
      let dayCount = 1;
      // ë³´ë“œíŒì„ 5í–‰ x 7ì—´ = 35ì¹¸ (31ì¼ + 4ì¹¸ ë‚¨ìŒ)
      const rows = 5;
      const cols = 7;

      for (let row = 0; row < rows; row++) {
        for (let col = 0; col < cols; col++) {
          if (dayCount > daysInMonth) break;

          // 3D íë¸Œ ìƒì„±
          const geometry = new THREE.BoxGeometry(4, 0.5, 4);
          const material = new THREE.MeshStandardMaterial({ color: 0xffffff });
          const cube = new THREE.Mesh(geometry, material);

          // íë¸Œ ë°°ì¹˜ (ì¹¸ì„ í¬ê²Œ)
          // col=0~6 => xì¢Œí‘œëŠ” (col-3)*4
          // row=0~4 => zì¢Œí‘œëŠ” -(row-2)*4
          let x = (col - 3) * 4;
          let z = -(row - 2) * 4;
          cube.position.set(x, 0, z);

          scene.add(cube);
          cubes.push(cube);

          // HTML ë‹¬ë ¥ ì¹¸
          const dayDiv = document.createElement("div");
          dayDiv.classList.add("day");
          if (col === 0) dayDiv.classList.add("sunday");
          if (col === 6) dayDiv.classList.add("saturday");
          dayDiv.innerHTML = `<strong>${dayCount}</strong><span>${daysOfWeek[col]}</span>`;
          calendarContainer.appendChild(dayDiv);

          dayCount++;
        }
      }
    }

    // ë³´íŠ¸(í”Œë ˆì´ì–´) ìƒì„±
    function createBoatPlayer() {
      const group = new THREE.Group();

      // 1) ë³´íŠ¸ ë³¸ì²´ (ì•„ë˜ìª½ íŒŒë€ ë¶€ë¶„)
      const bodyGeometry = new THREE.CylinderGeometry(2, 2.5, 5, 16);
      const bodyMaterial = new THREE.MeshStandardMaterial({ color: 0x0077ff });
      const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
      body.rotation.z = Math.PI / 2;
      group.add(body);

      // 2) ìƒì¸µë¶€ (ë…¸ë€ìƒ‰ ê°ì‹¤)
      const deckGeometry = new THREE.BoxGeometry(2.5, 1.8, 2);
      const deckMaterial = new THREE.MeshStandardMaterial({ color: 0xffdd00 });
      const deck = new THREE.Mesh(deckGeometry, deckMaterial);
      deck.position.set(0, 2.5, 0);
      group.add(deck);

      // 3) ì°½ë¬¸ (í°ìƒ‰ ì›)
      const windowGeometry = new THREE.CircleGeometry(0.3, 16);
      const windowMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff });
      for (let i = -0.7; i <= 0.7; i += 0.7) {
        const windowMesh = new THREE.Mesh(windowGeometry, windowMaterial);
        windowMesh.position.set(1.5, 2.5, i);
        windowMesh.rotation.y = Math.PI / 2;
        group.add(windowMesh);
      }

      // 4) ë›ëŒ€ (ì£¼í™©ìƒ‰ ê¸°ë‘¥)
      const poleGeometry = new THREE.CylinderGeometry(0.1, 0.1, 4, 8);
      const poleMaterial = new THREE.MeshStandardMaterial({ color: 0xff5500 });
      const pole = new THREE.Mesh(poleGeometry, poleMaterial);
      pole.position.set(0, 4, 0);
      group.add(pole);

      // ê·¸ë£¹ì„ ì”¬ì— ì¶”ê°€
      player = group;
      scene.add(player);

      // ì´ˆê¸° ìœ„ì¹˜ ê°±ì‹ 
      updatePlayerPosition();
    }

    // í”Œë ˆì´ì–´ ìœ„ì¹˜ ì´ë™
    function updatePlayerPosition() {
      if (playerPosition < cubes.length) {
        const position = cubes[playerPosition].position;

        // TWEENìœ¼ë¡œ ë¶€ë“œëŸ¬ìš´ ì´ë™
        new TWEEN.Tween(player.position)
          .to({ x: position.x, y: 1, z: position.z }, 1000)
          .easing(TWEEN.Easing.Sinusoidal.InOut)
          .start();
      }
    }

    // ì£¼ì‚¬ìœ„ êµ´ë¦¬ê¸°
    function rollDice() {
      const diceValue = Math.floor(Math.random() * 6) + 1;
      playerPosition = Math.min(playerPosition + diceValue, cubes.length - 1);
      updatePlayerPosition();
    }

    // í™”ë©´ ë¦¬ì‚¬ì´ì¦ˆ ëŒ€ì‘
    function onWindowResize() {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    }

    // ì• ë‹ˆë©”ì´ì…˜ ë£¨í”„
    function animate() {
      requestAnimationFrame(animate);
      
      // ë°° ë¬¼ê²° íš¨ê³¼
      waveTime += 0.03;
      if (player) {
        player.position.y = 1 + Math.sin(waveTime) * 0.2;
      }

      TWEEN.update();
      renderer.render(scene, camera);
    }

    // ì‹¤í–‰
    init();
  </script>
</body>
</html>