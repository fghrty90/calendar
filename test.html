<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>여객선 스타일 달력 보드게임</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Arial', sans-serif; background-color: #1a1a2e; text-align: center; }
        #game-container { display: flex; flex-direction: column; align-items: center; margin-top: 10px; }
        #controls { display: flex; gap: 10px; margin-bottom: 10px; }
        button {
            background: #0f3460; color: #fff; border: none; padding: 10px 15px;
            font-size: 16px; cursor: pointer; border-radius: 5px; transition: 0.3s;
        }
        button:hover { background: #00c3ff; }
        #calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; max-width: 400px; }
        .day { width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;
            border: 1px solid #ccc; font-size: 14px; background: #fff; border-radius: 5px; }
        .sunday { background: #ff5757; color: white; }
        .saturday { background: #579eff; color: white; }
    </style>
</head>
<body>

    <div id="game-container">
        <div id="controls">
            <button onclick="addPlayer()">➕ 플레이어 추가</button>
            <button onclick="removePlayer()">➖ 플레이어 삭제</button>
            <button onclick="rollDice()">🎲 주사위 굴리기</button>
        </div>
        <div id="calendar"></div>
    </div>

    <!-- ✅ Three.js & 기타 라이브러리 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>

    <script>
        let scene, camera, renderer, players = [];
        let playerPositions = [];
        let waveTime = 0;
        let currentPlayerIndex = 0;
        let calendarDays = [];

        function init() {
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x16213e);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 18, 12);
            camera.lookAt(0, 0, 0);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            createBoard();
            window.addEventListener('resize', onWindowResize);
            animate();
        }

        function createBoard() {
            const daysInMonth = 31;
            const days = ["일", "월", "화", "수", "목", "금", "토"];
            const calendarContainer = document.getElementById("calendar");

            calendarContainer.innerHTML = "";
            calendarDays = [];

            for (let i = 0; i < days.length; i++) {
                const dayHeader = document.createElement("div");
                dayHeader.classList.add("day");
                dayHeader.textContent = days[i];
                if (i === 0) dayHeader.classList.add("sunday");
                if (i === 6) dayHeader.classList.add("saturday");
                calendarContainer.appendChild(dayHeader);
            }

            for (let i = 1; i <= daysInMonth; i++) {
                const day = document.createElement("div");
                day.classList.add("day");
                day.textContent = i;
                if (i % 7 === 1) day.classList.add("sunday");
                if (i % 7 === 0) day.classList.add("saturday");
                calendarContainer.appendChild(day);
                calendarDays.push(day);
            }
        }

        function createShip() {
            const ship = new THREE.Group();

            // 🚢 본체 (길고 둥글게)
            const bodyGeometry = new THREE.CylinderGeometry(1.2, 1.5, 4, 12);
            const bodyMaterial = new THREE.MeshStandardMaterial({ color: 0xeeeeee });
            const body = new THREE.Mesh(bodyGeometry, bodyMaterial);
            body.rotation.z = Math.PI / 2;
            ship.add(body);

            // 🚢 상층부 (객실)
            const upperDeckGeometry = new THREE.BoxGeometry(1.5, 1, 2);
            const upperDeckMaterial = new THREE.MeshStandardMaterial({ color: 0xffffff });
            const upperDeck = new THREE.Mesh(upperDeckGeometry, upperDeckMaterial);
            upperDeck.position.set(0, 1, 0);
            ship.add(upperDeck);

            // 🚢 창문 (파란 원)
            for (let i = -0.5; i <= 0.5; i += 0.5) {
                const windowGeometry = new THREE.CircleGeometry(0.2, 16);
                const windowMaterial = new THREE.MeshStandardMaterial({ color: 0x3399ff });
                const window = new THREE.Mesh(windowGeometry, windowMaterial);
                window.position.set(1.1, 1, i);
                window.rotation.y = Math.PI / 2;
                ship.add(window);
            }

            ship.position.set(0, 0.5, 0);
            scene.add(ship);
            return ship;
        }

        function addPlayer() {
            if (players.length >= 4) {
                alert("최대 4명의 플레이어만 가능합니다.");
                return;
            }
            const player = createShip();
            players.push(player);
            playerPositions.push(0);
            updatePlayerPosition();
        }

        function removePlayer() {
            if (players.length === 0) {
                alert("삭제할 플레이어가 없습니다.");
                return;
            }
            const player = players.pop();
            scene.remove(player);
            playerPositions.pop();
            updatePlayerPosition();
        }

        function rollDice() {
            if (players.length === 0) {
                alert("플레이어를 먼저 추가해주세요!");
                return;
            }
            const diceValue = Math.floor(Math.random() * 6) + 1;
            let player = players[currentPlayerIndex];
            playerPositions[currentPlayerIndex] += diceValue;
            if (playerPositions[currentPlayerIndex] >= calendarDays.length) {
                playerPositions[currentPlayerIndex] = calendarDays.length - 1;
                alert(`🎉 플레이어 ${currentPlayerIndex + 1}가 도착했습니다!`);
            }

            updatePlayerPosition();
            currentPlayerIndex = (currentPlayerIndex + 1) % players.length;
        }

        function updatePlayerPosition() {
            players.forEach((player, index) => {
                const position = playerPositions[index];
                const targetX = (position % 7 - 3) * 2;
                const targetZ = -(Math.floor(position / 7) - 2) * 2;

                new TWEEN.Tween(player.position)
                    .to({ x: targetX, y: 0.75, z: targetZ }, 1000)
                    .easing(TWEEN.Easing.Sinusoidal.InOut)
                    .start();
            });
        }

        function animate() {
            requestAnimationFrame(animate);
            waveTime += 0.03;
            players.forEach(player => {
                player.position.y = 0.75 + Math.sin(waveTime) * 0.1;
            });
            TWEEN.update();
            renderer.render(scene, camera);
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        init();
    </script>
</body>
</html>